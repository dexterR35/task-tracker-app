# Copy this file to .env and fill in your values
# cp env.example .env

# PostgreSQL connection string
# Local: postgresql://user:password@localhost:5432/task_tracker
DATABASE_URL=postgresql://postgres:password@localhost:5432/task_tracker

# Allowed login domains (comma-separated). Single source of truth: set here and set the SAME value
# in the client as VITE_ALLOWED_LOGIN_DOMAINS (e.g. in .env at project root for Vite) to avoid
# server/client validation mismatch (server rejects invalid domain; client validates before submit).
# ALLOWED_LOGIN_DOMAINS=rei-d-services.com,netbet.com,netbet.ro,gimo.co.uk

# JWT secret (production: set a long random string, min 32 chars)
JWT_SECRET=your-super-secret-jwt-key-change-in-production
# Optional: previous secret for key rotation (verify old tokens while rotating)
# JWT_SECRET_PREVIOUS=old-secret
# Access token: short-lived; 5–10 min for high security, 10–15 min default
JWT_EXPIRES_IN=10m
# Optional: JWT issuer and audience for additional security
# JWT_ISSUER=task-tracker-api
# JWT_AUDIENCE=task-tracker-client
# Optional: log all JWT verification failures for auditing
# LOG_JWT_FAILURES=1

# Refresh tokens - Production-ready configuration
REFRESH_TOKEN_EXPIRES_DAYS=7
# Max refresh-token sessions per user (oldest revoked when exceeded). Default 5.
# REFRESH_TOKEN_MAX_DEVICES=5
# Cookie name for refresh token (httpOnly, secure in production)
REFRESH_TOKEN_COOKIE=refresh_token
# Optional: Cookie domain for subdomain sharing (e.g., .example.com)
# COOKIE_DOMAIN=

# Server
PORT=5000
NODE_ENV=development

# CORS: dev = single origin or true; production = explicit origin(s), comma-separated (no *)
# e.g. https://app.example.com or https://app.example.com,https://admin.example.com
CORS_ORIGIN=http://localhost:5173

# Rate limit: general API max requests per IP per min (default 100)
# API_RATE_LIMIT_MAX=100

# Rate limit: Production-ready auth rate limiting
AUTH_RATE_LIMIT_MAX=100                    # General auth routes rate limit per 15 minutes
# AUTH_LOGIN_RATE_LIMIT_MAX=5            # Login attempts per email per 15 minutes (default: 5)
# AUTH_REFRESH_RATE_LIMIT_MAX=30         # Token refresh attempts per IP per 15 minutes (default: 30)
# AUTH_LOGOUT_RATE_LIMIT_MAX=10          # Logout attempts per IP per minute (default: 10)

# Optional: log all JWT verification failures for auditing (LOG_JWT_FAILURES=1)
# LOG_JWT_FAILURES=1

# Optional: append auth audit logs to a file (path relative to cwd or absolute)
# AUTH_LOG_FILE=logs/auth-audit.jsonl

# Optional: redirect HTTP to HTTPS in production (or use reverse proxy)
# REDIRECT_HTTP_TO_HTTPS=true
